spring:
  application:
    name: collaborative-messenger

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: ${JPA_SHOW_SQL:false}
    open-in-view: false
    properties:
      hibernate:
        format_sql: true
        default_batch_fetch_size: 100

  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST:localhost}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      password: ${SPRING_DATA_REDIS_PASSWORD:redis1234}

  kafka:
    bootstrap-servers: ${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    listener:
      auto-startup: ${KAFKA_LISTENER_AUTO_STARTUP:false}
    consumer:
      group-id: messenger-chat-group
      auto-offset-reset: earliest
    producer: {}

  thymeleaf:
    cache: false
    prefix: classpath:/templates/
    suffix: .html

  mail:
    host: ${SPRING_MAIL_HOST:}
    port: ${SPRING_MAIL_PORT:465}
    username: ${SPRING_MAIL_USERNAME:}
    password: ${SPRING_MAIL_PASSWORD:}
    protocol: ${SPRING_MAIL_PROTOCOL:smtps}
    properties:
      mail:
        smtp:
          auth: ${SPRING_MAIL_SMTP_AUTH:true}
          starttls:
            enable: ${SPRING_MAIL_SMTP_STARTTLS_ENABLE:false}
        smtps:
          auth: true
          ssl:
            enable: true
          timeout: 10000
          connectiontimeout: 10000

  session:
    store-type: ${SPRING_SESSION_STORE_TYPE:none}
    timeout: 30m

datasource:
  shard0:
    url: ${DATASOURCE_SHARD0_URL:jdbc:mysql://localhost:3307/messenger_shard_0?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true}
    username: ${DATASOURCE_SHARD0_USERNAME:messenger}
    password: ${DATASOURCE_SHARD0_PASSWORD:messenger1234}
    driver-class-name: com.mysql.cj.jdbc.Driver
  shard1:
    url: ${DATASOURCE_SHARD1_URL:${DATASOURCE_SHARD0_URL:jdbc:mysql://localhost:3307/messenger_shard_0?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true}}
    username: ${DATASOURCE_SHARD1_USERNAME:${DATASOURCE_SHARD0_USERNAME:messenger}}
    password: ${DATASOURCE_SHARD1_PASSWORD:${DATASOURCE_SHARD0_PASSWORD:messenger1234}}
    driver-class-name: com.mysql.cj.jdbc.Driver

report:
  generation:
    cron: "0 0 18 * * MON-FRI"
    enabled: ${REPORT_GENERATION_ENABLED:false}

logging:
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] [traceId=%X{traceId}] [user=%X{userId}] %-5level %logger{36} - %msg%n"
  level:
    com.messenger: ${APP_LOG_LEVEL:INFO}
    com.messenger.infrastructure.sharding: ${SHARDING_LOG_LEVEL:INFO}
    com.messenger.infrastructure.kafka: INFO
    org.springframework.web.socket: INFO
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql: OFF

server:
  port: ${PORT:8888}
  tomcat:
    threads:
      max: ${TOMCAT_MAX_THREADS:40}
      min-spare: ${TOMCAT_MIN_SPARE_THREADS:5}
  servlet:
    session:
      cookie:
        http-only: true
        secure: ${SESSION_COOKIE_SECURE:false}

app:
  upload:
    dir: ${APP_UPLOAD_DIR:uploads}
  worklog:
    owner: ${WORKLOG_OWNER:kimsan259}
    repo: ${WORKLOG_REPO:collaborative-messenger}
    default-author: ${WORKLOG_DEFAULT_AUTHOR:kimsan4515}
    github-token: ${WORKLOG_GITHUB_TOKEN:}
    github-api-base-url: ${WORKLOG_GITHUB_API_BASE_URL:https://api.github.com}
    max-pages: ${WORKLOG_MAX_PAGES:6}
    summary-cache-ttl-seconds: ${WORKLOG_SUMMARY_CACHE_TTL_SECONDS:45}
    branch-cache-ttl-seconds: ${WORKLOG_BRANCH_CACHE_TTL_SECONDS:300}
    commit-detail-cache-ttl-seconds: ${WORKLOG_COMMIT_DETAIL_CACHE_TTL_SECONDS:120}
    recent-window-days: ${WORKLOG_RECENT_WINDOW_DAYS:2}
  mail:
    provider: ${APP_MAIL_PROVIDER:none}
    resend-api-key: ${RESEND_API_KEY:}
    from: ${APP_MAIL_FROM:onboarding@resend.dev}
  email-verification:
    code-ttl-minutes: ${EMAIL_VERIFICATION_TTL_MINUTES:10}
    verified-ttl-minutes: ${EMAIL_VERIFIED_TTL_MINUTES:30}
    debug-expose-code: ${EMAIL_VERIFICATION_DEBUG_EXPOSE_CODE:false}

  user-maintenance:
    prune-on-startup: ${USER_PRUNE_ON_STARTUP:true}
